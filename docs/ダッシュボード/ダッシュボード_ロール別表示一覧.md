# ダッシュボード — ロール別表示一覧

このドキュメントは、`frontend/src/features/dashboard/DashboardContent.tsx` の実装に基づき、各ロールごとにダッシュボードで表示されるデータ（KPI／リスト／サイドパネル項目）を一覧化したものです。

対象ロール
- 担当職員
- 担当税理士（所長）
- 上長（マネージャー）
- 管理者

---

## 共通（全ロール）
- 表示項目
  - タイトル: `ダッシュボード`
  - ようこそメッセージ: ユーザ名とロール
  - 今日の日付（曜日含む）
  - 進捗サマリー（右カラムのリングと数値）
    - 完了件数（`承認済み`）
    - 確認待ち件数（`承認待ち`）
    - 作業中件数（`作成中`）
    - 未着手件数（`未承認`）
  - 機能ショートカット（録音→自動作成 / RAG 検索 / 分析レポート）

---

## 担当職員 の表示項目

### KPI カード（上部 4 カード）
- `自分の担当数` — 自分が担当している案件数（`myCases.length`）
  - subtitle: "未送信報告"
- `進捗率` — 全体完了率（%）
  - subtitle: `承認済み: {承認済み件数} 件`
- `自分の期限超過` — 自分担当の 30 日以上経過かつ未承認の件数
  - subtitle: `30日以上の未処理`
- `重要指摘` — 自動抽出された長い指摘の件数（`てん末` の長文を抽出）

### メインパネル
- あなたの本日のタスクカード
  - 未送信報告: `{myCases.length} 件`
  - 操作ボタン: 録音開始、報告作成
  - 担当選択セレクト（担当職員リスト）
- あなたの最近の案件（カード）
  - ステータス別小計（未着手/作業中/確認待ち/完了）
  - テーブル（スクロール）表示: 各行に表示
    - 整理番号
    - 顧問先（委嘱者名称）
    - 処理日（処理年月日）
    - ステータス（バッジ）
    - 操作（編集、詳細）

### その他
- 自分の担当案件が空の場合、フロントでサンプル案件を合成して表示

---

## 担当税理士（所長）の表示項目

### KPI カード（上部 4 カード）
- `チーム総数` — チーム内の合計件数（teamSummary の合計）
  - subtitle: "担当案件（合計）"
- `承認待ち` — `承認待ち` 件数（statusCounts.確認待ち）
- `期限超過` — 30 日以上の期限超過件数（overdueRecords.length）
- `顧問先数` — 管理している顧問先数（uniqueClients.length）

### メインパネル
- 所長向けサマリ
  - 未承認の報告: `statusCounts.未着手`
  - 承認待ち: `statusCounts.確認待ち`
- チーム別件数テーブル（各担当職員ごと）
  - 担当職員名
  - 件数（total）
  - 期限超過（overdue）
  - 重要指摘（important）
- 重要な指摘（自動抽出）一覧（Paper リスト）
  - 顧問先名 — 整理番号
  - 要約（てん末）
  - ステータスバッジ

---

## 上長（マネージャー）の表示項目

### KPI カード（上部 4 カード）
- `期限超過` — overdueRecords.length
- `チーム未処理` — 作業中件数（statusCounts.作業中）
- `完了率` — 完了率（%）
- `担当者数` — uniqueStaff.length

### メインパネル
- マネージャーサマリ（テキスト表示）
  - チームの未処理: `statusCounts.作業中`
  - 期限超過（30日以上）: `overdueRecords.length`
- レビュー待ちの報告（最近の案件一覧）
  - 顧問先名
  - 担当（担当職員_氏名）
  - 処理日（フォーマット）
  - ステータス（バッジ）
- 期限超過一覧（抜粋）
  - 顧問先名 — 整理番号
  - 担当職員
  - 処理日

---

## 管理者 の表示項目

### KPI カード（上部 4 カード）
- `総報告数` — totalCases
  - subtitle: `顧問先: {uniqueClients.length} 社`
- `承認済み` — statusCounts.完了
- `承認待ち` — statusCounts.確認待ち
- `担当職員数` — uniqueStaff.length

### メインパネル
- 管理者パネル
  - システム統計（簡易）
    - 総報告数
    - 顧問先数
    - 担当職員数
  - ユーザー管理ボタン（ショートカット）

---

## サイドパネル（全ロール共通）
- 進捗状況（リング + 割合と内訳）
  - 完了（承認済み）
  - 確認待ち（承認待ち）
  - 作業中（作成中）
  - 未着手（未承認）
- 機能ショートカット（録音→自動作成 / RAG 検索 / 分析レポート）

---

## データ参照元（モック）
- フロントは `public/dashboard-records.json` をフェッチして表示データを構築します。
- 各レコードの主なフィールド（モック内の実例）:
  - `id` (string)
  - `委嘱者名称` (顧問先名)
  - `整理番号`
  - `処理年月日`
  - `担当職員_氏名`
  - `ステータス`（`未承認` / `作成中` / `承認待ち` / `承認済み`）
  - `てん末`（指摘・備考文）
  - `tenant_id`（組織スコープ）

---

## 備考 / 実装メモ
- ロールは `useAuthStore().user.role` を参照して切替。
- フロントでは `role === '担当職員'` の場合、該当ユーザの案件を `担当職員_氏名` でフィルタして `myCases` を算出している。
- 期限超過判定は `処理年月日` が現在から 30 日以上かつ `承認済み` でないもの。
- 重要指摘は `てん末` の文字数が閾値（例: 40 文字）より大きいものを抽出している。

---

作成: `docs/ダッシュボード/ダッシュボード_ロール別表示一覧.md`（自動生成）
